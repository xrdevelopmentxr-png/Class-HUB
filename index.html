<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Class HUB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;margin:0;color:white;background:#0f172a;transition:background 0.5s}
header{background:#020617;padding:16px;display:flex;justify-content:space-between}
button{padding:8px 12px;border:none;border-radius:6px;cursor:pointer;margin:4px}
.primary{background:#38bdf8;color:black}
.card{background:#020617;padding:16px;border-radius:12px;margin:12px 0}
input,select,textarea{padding:8px;width:100%;margin:6px 0;border-radius:6px;border:none}
textarea{background:#1e293b;color:white}
.hidden{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
.chat-box{background:#1e293b;padding:12px;border-radius:12px;max-height:200px;overflow-y:auto;margin-bottom:6px}
</style>
</head>
<body>

<header>
<h1>Class HUB</h1>
<div id="userInfo"></div>
</header>

<main style="padding:16px">

<div id="auth" class="card">
<h2>Sign In / Create</h2>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button class="primary" id="loginBtn">Enter</button>
</div>

<div id="dashboard" class="hidden">

<div class="card">
<h2>Points: <span id="points">0</span></h2>
</div>

<div class="card">
<h2>üåç Global Leaderboard</h2>
<ol id="leaderboard"></ol>
</div>

<h2>üéÆ Games</h2>
<div class="grid">
<button onclick="mathTF()">True / False Math</button>
<button onclick="mathQuestion()">Quick Math</button>
<button onclick="englishGame()">Kind Words</button>
<button onclick="norwegianGame()">Translate to Norwegian</button>
</div>

<h2>‚öôÔ∏è User Settings</h2>
<div class="card">
<h3>Change Username</h3>
<input id="newUsername" placeholder="New Username">
<button class="primary" onclick="changeUsername()">Update Username</button>

<h3>Change Password</h3>
<input id="newPassword" type="password" placeholder="New Password">
<button class="primary" onclick="changePassword()">Update Password</button>

<h3>Background Color</h3>
<select id="bgColorSelect" onchange="changeBackground()">
  <option value="black">Black</option>
  <option value="white">White</option>
  <option value="rainbow">Rainbow</option>
  <option value="redGreen">Red & Green</option>
</select>
</div>

<h2>üí¨ Global Chat</h2>
<div class="card">
<div id="chatBox" class="chat-box"></div>
<textarea id="chatInput" placeholder="Type your message..."></textarea>
<button class="primary" onclick="sendMessage()">Send</button>
</div>

<div id="game" class="card hidden"></div>

</div>
</main>

<script>
let currentUser=null, users={};

// LOGIN
loginBtn.onclick=()=>{
 const u=username.value.trim(), p=password.value.trim();
 if(!u||!p) return alert("Enter info");
 users=JSON.parse(localStorage.getItem("users")||"{}");
 if(!users[u]) users[u]={password:p,points:0};
 if(users[u].password!==p) return alert("Wrong password");
 localStorage.setItem("users",JSON.stringify(users));
 currentUser=u;
 auth.classList.add("hidden");
 dashboard.classList.remove("hidden");
 userInfo.innerHTML="Logged in as <b>"+u+"</b>";
 update();
 loadChat();
};

// UPDATE POINTS AND LEADERBOARD
function update(){
 users=JSON.parse(localStorage.getItem("users"));
 points.innerText=users[currentUser].points;
 renderLeaderboard();
}
function addPoints(n){
 users[currentUser].points+=n;
 localStorage.setItem("users",JSON.stringify(users));
 update();

  // Optional effect in chat
  const effectMsg=`${currentUser} got ${n} points üí•`;
  const chat=JSON.parse(localStorage.getItem("globalChat")||"[]");
  chat.push({user:"SYSTEM", text:effectMsg});
  localStorage.setItem("globalChat",JSON.stringify(chat));
  loadChat();
}

// LEADERBOARD
function renderLeaderboard(){
 leaderboard.innerHTML="";
 Object.entries(users)
  .sort((a,b)=>b[1].points-a[1].points)
  .slice(0,10)
  .forEach(u=>{
    const li=document.createElement("li");
    li.textContent=`${u[0]} ‚Äî ${u[1].points}`;
    leaderboard.appendChild(li);
  });
}

// MATH GAMES
function mathQuestion(){
 const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
 game.classList.remove("hidden");
 game.innerHTML=`<h3>${a} + ${b} = ?</h3>
 <input id="ans"><button onclick="checkMath(${a+b})">Submit</button>`;
}
function checkMath(c){
 if(Number(ans.value)===c){alert("Correct!");addPoints(10);}
 else alert("Wrong");
 game.classList.add("hidden");
}
function mathTF(){
 const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
 const correct=Math.random()>0.5;
 const shown=correct?a*b:a*b+1;
 game.classList.remove("hidden");
 game.innerHTML=`<h3>${a} √ó ${b} = ${shown}</h3>
 <button onclick="tf(true,${correct})">True</button>
 <button onclick="tf(false,${correct})">False</button>`;
}
function tf(c,ans){
 if(c===ans){alert("Correct!");addPoints(10);}
 else alert("Wrong");
 game.classList.add("hidden");
}

// ENGLISH GAME
const niceWords=["you are cool","nice shirt","wanna play?","you are nice"];
function englishGame(){
 const w=niceWords[Math.floor(Math.random()*niceWords.length)];
 game.classList.remove("hidden");
 game.innerHTML=`<h3>Type this phrase:</h3><b>${w}</b>
 <input id="typeWord"><button onclick="checkWord('${w}')">Submit</button>`;
}
function checkWord(w){
 if(typeWord.value.toLowerCase()===w){alert("Nice! +10"); addPoints(10);}
 else alert("Try again");
 game.classList.add("hidden");
}

// NORWEGIAN GAME
const norwegian={"you are cool":"du er kul","you are nice":"du er snill"};
function norwegianGame(){
 const keys=Object.keys(norwegian);
 const q=keys[Math.floor(Math.random()*keys.length)];
 game.classList.remove("hidden");
 game.innerHTML=`<h3>Translate to Norwegian:</h3><b>${q}</b>
 <input id="nor"><button onclick="checkNor('${q}')">Submit</button>`;
}
function checkNor(q){
 if(nor.value.toLowerCase()===norwegian[q]){alert("Correct! +10"); addPoints(10);}
 else alert("Wrong");
 game.classList.add("hidden");
}

// -----------------
// USER SETTINGS
function changeUsername(){
 const newU=newUsername.value.trim();
 if(!newU) return alert("Enter new username");
 if(users[newU]) return alert("Username exists");
 users[newU]={...users[currentUser]};
 delete users[currentUser];
 localStorage.setItem("users",JSON.stringify(users));
 currentUser=newU;
 userInfo.innerHTML="Logged in as <b>"+currentUser+"</b>";
 update();
 alert("Username changed!");
}
function changePassword(){
 const newP=newPassword.value.trim();
 if(!newP) return alert("Enter new password");
 users[currentUser].password=newP;
 localStorage.setItem("users",JSON.stringify(users));
 alert("Password updated!");
}

// BACKGROUND
function changeBackground(){
 const color=bgColorSelect.value;
if(color==="black") document.body.style.background="#0f172a";
else if(color==="white") document.body.style.background="white";
else if(color==="rainbow") document.body.style.background="linear-gradient(270deg,red,orange,yellow,green,blue,indigo,violet)";
else if(color==="redGreen") document.body.style.background="repeating-linear-gradient(45deg, red, red 50px, green 50px, green 100px)";
}

// -----------------
// GLOBAL CHAT
function loadChat(){
 const chat=JSON.parse(localStorage.getItem("globalChat")||"[]");
 const chatBox=document.getElementById("chatBox");
 chatBox.innerHTML="";
 chat.forEach(msg=>{
   const div=document.createElement("div");
   div.textContent=msg.user==="SYSTEM"?msg.text:`${msg.user}: ${msg.text}`;
   chatBox.appendChild(div);
 });
 chatBox.scrollTop=chatBox.scrollHeight;
}
function sendMessage(){
 const msgText=document.getElementById("chatInput").value.trim();
 if(!msgText) return;
 const chat=JSON.parse(localStorage.getItem("globalChat")||"[]");
 chat.push({user:currentUser,text:msgText});
 localStorage.setItem("globalChat",JSON.stringify(chat));
 document.getElementById("chatInput").value="";
 loadChat();
}

// SECRET: press "√•" to get 100000 points
document.addEventListener("keydown", e=>{
 if(e.key==="√•"){addPoints(100000); alert("Secret unlocked! +100000 points");}
});
</script>
</body>
</html>
