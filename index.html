<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Class HUB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;margin:0;color:white;background:#0f172a;transition:background .5s}
header{background:#020617;padding:16px;display:flex;justify-content:space-between}
button{padding:8px 12px;border:none;border-radius:6px;cursor:pointer;margin:4px}
.primary{background:#38bdf8;color:black}
.card{background:#020617;padding:16px;border-radius:12px;margin:12px 0}
input,select,textarea{padding:8px;width:100%;margin:6px 0;border-radius:6px;border:none}
textarea{background:#1e293b;color:white}
.hidden{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
.chat-box{background:#1e293b;padding:12px;border-radius:12px;max-height:200px;overflow-y:auto}
canvas{background:#020617;display:block;margin:auto;border-radius:8px}
</style>
</head>

<body>

<header>
<h1>Class HUB</h1>
<div id="userInfo"></div>
</header>

<main style="padding:16px">

<div id="auth" class="card">
<h2>Sign In / Create</h2>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button class="primary" id="loginBtn">Enter</button>
</div>

<div id="dashboard" class="hidden">

<div class="card">
<h2>Points: <span id="points">0</span></h2>
</div>

<div class="card">
<h2>üåç Leaderboard</h2>
<ol id="leaderboard"></ol>
</div>

<h2>üéÆ Games</h2>
<div class="grid">
<button onclick="mathTF()">True / False Math</button>
<button onclick="mathQuestion()">Quick Math</button>
<button onclick="speedMath()">‚ö° Speed Math</button>
<button onclick="multiRush()">‚úñÔ∏è Multiply Rush</button>
<button onclick="startUNO()">üÉè UNO</button>
<button onclick="showFloppyMenu()">üê¶ Floppy Bird</button>
</div>

<h2>üë§ Profile Checker</h2>
<div class="card">
<input id="searchUser" placeholder="Username">
<button onclick="checkProfile()">Search</button>
<p id="profileResult"></p>
</div>

<h2>‚öôÔ∏è User Settings</h2>
<div class="card">
<h3>Change Password</h3>
<input id="newPassword" type="password" placeholder="New Password">
<button onclick="changePassword()">Update</button>

<h3>Background</h3>
<select id="bgColorSelect" onchange="changeBackground()">
<option value="black">Black</option>
<option value="white">White</option>
<option value="rainbow">Rainbow</option>
<option value="redGreen">Red & Green</option>
</select>
</div>

<div id="game" class="card hidden"></div>

</div>
</main>

<script>
let currentUser=null, users={};

// LOGIN
loginBtn.onclick=()=>{
 const u=username.value.trim(),p=password.value.trim();
 if(!u||!p) return alert("Enter info");
 users=JSON.parse(localStorage.getItem("users")||"{}");
 if(!users[u]) users[u]={password:p,points:0};
 if(users[u].password!==p) return alert("Wrong password");
 localStorage.setItem("users",JSON.stringify(users));
 currentUser=u;
 auth.classList.add("hidden");
 dashboard.classList.remove("hidden");
 userInfo.innerHTML="Logged in as <b>"+u+"</b>";
 update();
};

// UPDATE
function update(){
 users=JSON.parse(localStorage.getItem("users"));
 points.innerText=users[currentUser].points;
 leaderboard.innerHTML="";
 Object.entries(users).sort((a,b)=>b[1].points-a[1].points)
 .slice(0,10).forEach(u=>{
  const li=document.createElement("li");
  li.textContent=`${u[0]} ‚Äî ${u[1].points}`;
  leaderboard.appendChild(li);
 });
}
function addPoints(n){
 users[currentUser].points+=n;
 localStorage.setItem("users",JSON.stringify(users));
 update();
}

// BACKGROUND
function changeBackground(){
 const c=bgColorSelect.value;
 if(c==="black") document.body.style.background="#0f172a";
 if(c==="white") document.body.style.background="white";
 if(c==="rainbow") document.body.style.background="linear-gradient(270deg,red,orange,yellow,green,blue,indigo,violet)";
 if(c==="redGreen") document.body.style.background="repeating-linear-gradient(45deg,red,red 50px,green 50px,green 100px)";
}

// PASSWORD
function changePassword(){
 const p=newPassword.value.trim();
 if(!p) return alert("Enter password");
 users[currentUser].password=p;
 localStorage.setItem("users",JSON.stringify(users));
 alert("Password changed");
}

// PROFILE CHECKER
function checkProfile(){
 const u=searchUser.value.trim();
 users=JSON.parse(localStorage.getItem("users")||"{}");
 profileResult.textContent=
  users[u]?`${u} has ${users[u].points} points`:"User not found";
}

// ---------- MATH GAMES ----------
function mathQuestion(){
 const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
 game.classList.remove("hidden");
 game.innerHTML=`${a}+${b}=?<br><input id="ans"><button onclick="if(ans.value==${a+b}){addPoints(10);alert('Correct')}game.classList.add('hidden')">OK</button>`;
}
function mathTF(){
 const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
 const c=Math.random()>0.5,shown=c?a*b:a*b+1;
 game.classList.remove("hidden");
 game.innerHTML=`${a}√ó${b}=${shown}<br>
 <button onclick="tf(true,${c})">True</button>
 <button onclick="tf(false,${c})">False</button>`;
}
function tf(x,y){if(x===y){addPoints(10);alert("Correct")}game.classList.add("hidden");}

// SPEED MATH
function speedMath(){
 let score=0;
 for(let i=0;i<5;i++){
  const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
  if(prompt(`${a}+${b}`)==a+b) score++;
 }
 addPoints(score*5);
 alert(`You got ${score}/5`);
}

// MULTIPLY RUSH
function multiRush(){
 let ok=0;
 for(let i=0;i<5;i++){
  const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
  if(prompt(`${a}√ó${b}`)==a*b) ok++;
 }
 addPoints(ok*5);
 alert(`Correct: ${ok}`);
}

// ---------- UNO ----------
let unoColors=["Red","Green","Blue","Yellow"];
function drawCard(){return unoColors[Math.floor(Math.random()*4)]+" "+(Math.floor(Math.random()*9)+1);}
let playerCard, cpuCard;

function startUNO(){
 playerCard=drawCard();
 cpuCard=drawCard();
 game.classList.remove("hidden");
 game.innerHTML=`
 <h3>UNO</h3>
 <p>Your card: <b>${playerCard}</b></p>
 <p>CPU card: <b>${cpuCard}</b></p>
 <button onclick="playUNO()">Play</button>`;
}
function playUNO(){
 if(playerCard.split(" ")[0]===cpuCard.split(" ")[0] ||
    playerCard.split(" ")[1]===cpuCard.split(" ")[1]){
  alert("You win! +20");
  addPoints(20);
 }else alert("No match, you lose");
 game.classList.add("hidden");
}

// ---------- FLOPPY BIRD (iPad friendly) ----------
let birdY,vel,pipeX,scoreFB,loop;
function showFloppyMenu(){
 game.classList.remove("hidden");
 game.innerHTML=`
 <h3>Floppy Bird</h3>
 <button class="primary" onclick="startFloppyBird()">Start</button>
 <canvas id="cv" width="300" height="400"></canvas>`;
}
function startFloppyBird(){
 const ctx=cv.getContext("2d");
 birdY=200;vel=0;pipeX=300;scoreFB=0;

 function flap(){vel=-6;}
 document.onclick=flap;
 document.ontouchstart=flap;

 loop=setInterval(()=>{
  ctx.clearRect(0,0,300,400);
  vel+=0.4; birdY+=vel; pipeX-=2;
  if(pipeX<-50){pipeX=300;scoreFB++;}
  ctx.fillRect(50,birdY,20,20);
  ctx.fillRect(pipeX,0,40,150);
  ctx.fillRect(pipeX,250,40,200);
  if(birdY<0||birdY>380||(pipeX<70&&pipeX>30&&(birdY<150||birdY>230))){
   clearInterval(loop); alert("Game Over"); game.classList.add("hidden");
  }
  if(scoreFB===5){clearInterval(loop); finishFloppyMath();}
 },20);
}
function finishFloppyMath(){
 let ok=0;
 for(let i=0;i<3;i++){
  const a=Math.floor(Math.random()*10),b=Math.floor(Math.random()*10);
  if(prompt(`${a}+${b}`)==a+b) ok++;
 }
 if(ok===3){addPoints(30);alert("You win!")}
 game.classList.add("hidden");
}
</script>
</body>
</html>
